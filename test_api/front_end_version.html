<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API POST Request</title>
</head>
<body>
    <input type="text" id="inputField" placeholder="Prompt" value="a car">
    <button id="postButton">Send to Beam</button>
    <select id="dropdown">
        <option value="None">None</option>
        <option value="3D Model">3D Model</option>
        <option value="Analog Film">Analog Film</option>
        <option value="Anime">Anime</option>
        <option value="Pencil Sketch">Pencil Sketch</option>
        <option value="Comic Book">Comic Book</option>
        <option value="Digital Art">Digital Art</option>
        <option value="Lowpoly">Lowpoly</option>
        <option value="Photographic">Photographic</option>
        <option value="Abstract">Abstract</option>
        <option value="Watercolor">Watercolor</option>
        <option value="Monochrome">Monochrome</option>
    </select>    
    <input type="number" id="numberInput" placeholder=0 value=0>
    <img id="resultImage" src='' alt="Returned Image" style="margin-top: 20px;">
    
<script>
    async function postData() {
        const imageElement = document.getElementById('resultImage');
        imageElement.src = '';
        const url = 'https://apps.beam.cloud/hmvz6';

         // Get content from the input text field
        const inputContent = document.getElementById('inputField').value;

        var dropdown = document.getElementById("dropdown");
        
        // Get the selected value from the dropdown
        const selectedValueDropDown = dropdown.options[dropdown.selectedIndex].value;

        // Get the value from the number input
        var numberInput = document.getElementById("numberInput");
        const inputValue = numberInput.value;
        
        // Custom headers
        const headers = new Headers({
            'Authorization': 'Basic ' + 'NDZhYTMzMTg3N2UxNmVkYTg2OTkxYTVmNTg1MTc5ZTM6ZThiNGIzNGI3NDAwYjczZTgyZTk2ZjIyZTlmZWQ4ZDM=',
            'Content-Type': 'application/json' // Assuming you're sending JSON data
        });

        // Data you want to send in the POST request
        const data = {
            prompt: inputContent,
            style: selectedValueDropDown,
            seed: parseInt(inputValue)
        };

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            const responseData = await response.json();
            console.log(responseData);

             //const responseData = await response.json();
             //const responseData = await response.data(); // Assuming the response is just the base64 string
            const imageElement = document.getElementById('resultImage');
            imageElement.src = 'data:image/png;base64,' + responseData['image'];
            //console.log(responseData['pred']);
        } catch (error) {
            console.error('Error posting data:', error);
        }
    }

    // Call the function to make the POST request
    document.getElementById('postButton').addEventListener('click', postData);
</script>

</body>
</html>